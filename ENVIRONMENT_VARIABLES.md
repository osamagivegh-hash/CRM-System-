# Environment Variables Configuration

This document outlines all environment variables required for the CRM system deployment on Render.

## Backend Environment Variables

### Required Variables

| Variable | Description | Example Value | Required |
|----------|-------------|---------------|----------|
| `NODE_ENV` | Environment mode | `production` | Yes |
| `PORT` | Server port | `10000` | Yes |
| `MONGODB_URI` | MongoDB connection string | Auto-generated by Render | Yes |
| `JWT_SECRET` | JWT signing secret | Auto-generated by Render | Yes |
| `JWT_EXPIRE` | JWT token expiration | `7d` | Yes |
| `BCRYPT_ROUNDS` | Bcrypt salt rounds | `12` | Yes |
| `FRONTEND_URL` | Frontend application URL | Auto-generated by Render | Yes |

### Optional Variables

| Variable | Description | Default Value | Required |
|----------|-------------|---------------|----------|
| `RATE_LIMIT_WINDOW_MS` | Rate limiting window | `900000` (15 min) | No |
| `RATE_LIMIT_MAX_REQUESTS` | Max requests per window | `100` | No |

## Frontend Environment Variables

### Required Variables

| Variable | Description | Example Value | Required |
|----------|-------------|---------------|----------|
| `REACT_APP_API_URL` | Backend API URL | Auto-generated by Render | Yes |

### Optional Variables

| Variable | Description | Default Value | Required |
|----------|-------------|---------------|----------|
| `GENERATE_SOURCEMAP` | Generate source maps | `false` | No |

## Database Configuration

The MongoDB database is automatically configured by Render with the following settings:
- **Database Name**: `crm_production`
- **Plan**: `starter`
- **Region**: `oregon`

## Environment Variable Sources

### Auto-Generated by Render
- `MONGODB_URI`: Automatically provided from the database service
- `JWT_SECRET`: Automatically generated secure secret
- `FRONTEND_URL`: Automatically provided from the frontend service
- `REACT_APP_API_URL`: Automatically provided from the backend service

### Manual Configuration
All other variables are set in the `render.yaml` blueprint file and don't require manual configuration.

## Security Notes

1. **JWT_SECRET**: Automatically generated by Render for security
2. **MONGODB_URI**: Automatically provided and secured by Render
3. **CORS**: Configured to only allow requests from the frontend URL
4. **Rate Limiting**: Enabled to prevent abuse

## Development vs Production

### Development
- Use `backend/env.example` and `frontend/env.example` as templates
- Set `NODE_ENV=development`
- Use local MongoDB instance
- CORS allows localhost origins

### Production
- All variables managed by Render blueprint
- `NODE_ENV=production`
- MongoDB hosted on Render
- CORS restricted to production frontend URL

## Troubleshooting

### Common Issues

1. **CORS Errors**: Ensure `FRONTEND_URL` matches the actual frontend URL
2. **Database Connection**: Verify `MONGODB_URI` is correctly set
3. **JWT Issues**: Check that `JWT_SECRET` is set and consistent
4. **API Connection**: Verify `REACT_APP_API_URL` points to the correct backend

### Validation Commands

```bash
# Check backend environment
curl https://your-backend-url.onrender.com/api/health

# Check frontend build
npm run build:production
```

## Environment Variable Priority

1. Render service environment variables (highest priority)
2. `.env` files (development only)
3. Default values in code (lowest priority)
